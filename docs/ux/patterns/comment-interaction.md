# 댓글 인터랙션 플로우 설계

## UX-MVP-003: 댓글 시스템 UX 패턴

### 개요
댓글 시스템은 사용자 간 소통의 핵심 기능입니다. 이 문서는 댓글 작성, 수정, 삭제, 답글의 전체 인터랙션 플로우를 정의합니다.

---

## 1. 댓글 작성 플로우

### 1.1 기본 댓글 작성

```
[게시글 상세] ──▶ [댓글 입력창 포커스] ──▶ [내용 입력] ──▶ [등록 버튼] ──▶ [댓글 추가]
      │                  │                    │               │              │
      ▼                  ▼                    ▼               ▼              ▼
   콘텐츠 소비       참여 의도            의견 작성        제출 기대      만족/참여감
```

### 1.2 상태별 UI

#### 비활성 상태 (기본)
```
┌─────────────────────────────────────────────────────────────┐
│  👤  [댓글을 입력하세요...                      ] [등록]    │
│      └─ placeholder 텍스트                        └─ 비활성 │
└─────────────────────────────────────────────────────────────┘
```

#### 활성 상태 (포커스)
```
┌─────────────────────────────────────────────────────────────┐
│  👤  ┌──────────────────────────────────────────┐           │
│      │ 좋은 글이네요! 공감합니다.               │  [등록]   │
│      │                                          │   └─ 활성 │
│      │                                          │           │
│      └──────────────────────────────────────────┘           │
│      0/500                                                  │
└─────────────────────────────────────────────────────────────┘
```

#### 제출 중 상태
```
┌─────────────────────────────────────────────────────────────┐
│  👤  ┌──────────────────────────────────────────┐           │
│      │ 좋은 글이네요! 공감합니다.               │  [◌...]   │
│      └──────────────────────────────────────────┘   └─ 로딩 │
└─────────────────────────────────────────────────────────────┘
```

### 1.3 댓글 작성 규칙

| 항목 | 값 | 설명 |
|------|-----|------|
| 최소 길이 | 1자 | 공백만으로는 등록 불가 |
| 최대 길이 | 500자 | 초과 시 입력 불가 |
| 멘션 | @username | 자동완성 지원 |
| 줄바꿈 | Shift + Enter | 일반 Enter는 제출 (설정 가능) |

---

## 2. 답글 플로우

### 2.1 답글 작성 흐름

```
[댓글 확인] ──▶ [답글 버튼 클릭] ──▶ [답글 입력창 표시] ──▶ [내용 입력] ──▶ [등록]
     │               │                    │                    │             │
     ▼               ▼                    ▼                    ▼             ▼
  댓글 읽기      답글 의도          @멘션 자동추가        답글 작성      대화 참여
```

### 2.2 답글 UI

```
┌─────────────────────────────────────────────────────────────┐
│  👤 원댓글작성자  •  1시간 전                               │
│  ────────────────────────────────────────────────────────── │
│  원래 댓글 내용입니다.                                      │
│  ────────────────────────────────────────────────────────── │
│  ❤️ 5     [답글 달기]     ← 클릭                            │
│                                                             │
│  ┌────────────────────────────────────────────────────────┐ │
│  │  👤 나의프로필                                         │ │
│  │  ┌──────────────────────────────────────────────────┐  │ │
│  │  │ @원댓글작성자 |                                  │  │ │
│  │  │              ← 자동으로 멘션 추가                │  │ │
│  │  └──────────────────────────────────────────────────┘  │ │
│  │  [취소]                                       [등록]   │ │
│  └────────────────────────────────────────────────────────┘ │
│                                                             │
│  ▼ 기존 답글 2개                                            │
│                                                             │
│    ┌─────────────────────────────────────────────────────┐  │
│    │  👤 답글작성자1  •  30분 전                         │  │
│    │  @원댓글작성자 답글 내용입니다.                     │  │
│    └─────────────────────────────────────────────────────┘  │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 2.3 답글 표시 로직

| 답글 수 | 표시 방식 |
|---------|----------|
| 0개 | 답글 영역 숨김 |
| 1-3개 | 모든 답글 표시 |
| 4개 이상 | 최근 2개 표시 + "답글 N개 더 보기" |

---

## 3. 댓글 수정 플로우

### 3.1 수정 진입

```
[댓글 더보기(⋮)] ──▶ [수정 선택] ──▶ [인라인 에디터] ──▶ [내용 수정] ──▶ [저장]
        │                │                 │                  │             │
        ▼                ▼                 ▼                  ▼             ▼
    메뉴 열기        수정 모드         기존 내용 로드      내용 변경     수정 완료
```

### 3.2 수정 UI

#### 더보기 메뉴 (본인 댓글)
```
        [⋮]
          ↓
  ┌─────────────────┐
  │  ✏️ 수정하기    │
  │  🗑️ 삭제하기    │
  └─────────────────┘
```

#### 인라인 수정 모드
```
┌─────────────────────────────────────────────────────────────┐
│  👤 나의닉네임  •  1시간 전  •  수정 중                      │
│  ┌────────────────────────────────────────────────────────┐ │
│  │ 수정할 댓글 내용입니다.                                │ │
│  │ 이 부분을 변경할 수 있습니다.                          │ │
│  └────────────────────────────────────────────────────────┘ │
│  [취소]                                           [저장]    │
└─────────────────────────────────────────────────────────────┘
```

### 3.3 수정 표시

수정된 댓글은 시간 옆에 "(수정됨)" 표시:
```
👤 닉네임  •  1시간 전 (수정됨)
```

---

## 4. 댓글 삭제 플로우

### 4.1 삭제 확인 모달

```
┌─────────────────────────────────────┐
│                                     │
│         ⚠️ 댓글 삭제                │
│                                     │
│    이 댓글을 삭제하시겠습니까?      │
│                                     │
│    [취소]           [삭제]          │
│                                     │
└─────────────────────────────────────┘
```

### 4.2 삭제 후 처리

| 상황 | 처리 방식 |
|------|----------|
| 답글이 없는 댓글 | 완전 삭제, UI에서 제거 |
| 답글이 있는 댓글 | "삭제된 댓글입니다" 표시 |

#### 삭제된 댓글 표시 (답글 있는 경우)
```
┌─────────────────────────────────────────────────────────────┐
│  [삭제된 댓글입니다]                                        │
│                                                             │
│    ┌─────────────────────────────────────────────────────┐  │
│    │  👤 답글작성자  •  30분 전                          │  │
│    │  이 답글은 그대로 유지됩니다.                       │  │
│    └─────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────┘
```

---

## 5. 멘션(@) 기능

### 5.1 멘션 자동완성

```
입력 중: "@김"

┌────────────────────────────────────────┐
│  @김│                                  │
│    ↓                                   │
│  ┌────────────────────────────────┐    │
│  │  👤 김철수 (@kimcs)            │    │
│  │  👤 김영희 (@kimyh)            │    │
│  │  👤 김민수 (@kimms)            │    │
│  └────────────────────────────────┘    │
└────────────────────────────────────────┘
```

### 5.2 멘션 규칙

| 동작 | 결과 |
|------|------|
| @ 입력 | 자동완성 드롭다운 표시 |
| 사용자 선택 | 멘션 태그로 변환 |
| 멘션된 사용자 | 알림 수신 |

### 5.3 멘션 표시

```
@김철수 님 의견에 동의합니다!
  └─ 클릭 시 해당 사용자 프로필로 이동
     하이라이트 색상으로 구분
```

---

## 6. 댓글 정렬

### 6.1 정렬 옵션

```
💬 댓글 12개                              [최신순 ▼]
                                              ↓
                                    ┌─────────────┐
                                    │ ✓ 최신순    │
                                    │   인기순    │
                                    │   오래된순  │
                                    └─────────────┘
```

| 정렬 | 기준 |
|------|------|
| 최신순 (기본) | 작성 시간 내림차순 |
| 인기순 | 좋아요 수 내림차순 |
| 오래된순 | 작성 시간 오름차순 |

---

## 7. 댓글 좋아요

### 7.1 좋아요 토글

```
기본 상태:      →      좋아요 상태:
❤️ 5                    ♥️ 6
└─ 빈 하트               └─ 채워진 하트 + 숫자 증가
```

### 7.2 애니메이션

```
클릭 순간:
  ♥️ ← 스케일 업 (1.2배) → 원래 크기

숫자 변경:
  5 → 6 (슬라이드 업 애니메이션)
```

---

## 8. 에러 처리

### 8.1 네트워크 오류

```
┌─────────────────────────────────────────────────────────────┐
│  ⚠️ 댓글을 등록할 수 없습니다                               │
│                                                             │
│  네트워크 연결을 확인해주세요.                              │
│                                                             │
│  [다시 시도]                                    [나중에]    │
└─────────────────────────────────────────────────────────────┘
```

### 8.2 입력 검증 오류

| 상황 | 메시지 |
|------|--------|
| 빈 내용 | "댓글 내용을 입력해주세요" |
| 글자 수 초과 | "댓글은 500자까지 입력 가능합니다" |
| 금지어 포함 | "부적절한 내용이 포함되어 있습니다" |

---

## 9. 접근성 고려사항

| 항목 | 구현 |
|------|------|
| 키보드 네비게이션 | Tab으로 댓글 간 이동 |
| 스크린 리더 | aria-label로 댓글 정보 제공 |
| 포커스 표시 | 현재 포커스된 댓글 하이라이트 |
| 대체 텍스트 | 아이콘에 title 속성 |

---

## 10. 성능 최적화

| 기능 | 최적화 방법 |
|------|------------|
| 댓글 로딩 | 페이지네이션 (20개씩) |
| 답글 로딩 | Lazy loading |
| 이미지 | 프로필 이미지 캐싱 |
| 실시간 업데이트 | WebSocket (선택적) |
