# 새 글 작성 페이지 개선 - QA 테스트 계획

## 1. 테스트 범위

### 1.1 미리보기 기능
| ID | 테스트 케이스 | 우선순위 |
|----|-------------|----------|
| PRV-001 | 미리보기 버튼 클릭 시 모달이 열림 | P0 |
| PRV-002 | 모달에 제목이 표시됨 | P0 |
| PRV-003 | 모달에 채널명이 표시됨 | P0 |
| PRV-004 | 모달에 태그가 표시됨 | P0 |
| PRV-005 | 모달에 마크다운이 렌더링됨 | P0 |
| PRV-006 | 모달에 이미지가 표시됨 | P0 |
| PRV-007 | 모달에 참고 링크가 표시됨 | P1 |
| PRV-008 | ESC 키로 모달 닫기 | P1 |
| PRV-009 | 배경 클릭으로 모달 닫기 | P1 |
| PRV-010 | X 버튼으로 모달 닫기 | P1 |
| PRV-011 | 모바일에서 전체화면으로 표시 | P1 |
| PRV-012 | XSS 공격 코드가 sanitize됨 | P0 |

### 1.2 이미지 업로드 기능
| ID | 테스트 케이스 | 우선순위 |
|----|-------------|----------|
| IMG-001 | 이미지 버튼 클릭 시 파일 선택 다이얼로그 열림 | P0 |
| IMG-002 | 이미지 선택 후 업로드 진행 표시 | P0 |
| IMG-003 | 업로드 완료 후 마크다운 삽입 | P0 |
| IMG-004 | 커서 위치에 마크다운 삽입 | P1 |
| IMG-005 | 여러 이미지 동시 업로드 | P0 |
| IMG-006 | 드래그앤드롭으로 업로드 | P1 |
| IMG-007 | Ctrl+V로 클립보드 이미지 업로드 | P2 |
| IMG-008 | 10MB 초과 파일 에러 표시 | P0 |
| IMG-009 | 지원하지 않는 형식 에러 표시 | P0 |
| IMG-010 | 10장 초과 시 에러 표시 | P0 |
| IMG-011 | 업로드 실패 시 에러 표시 | P0 |
| IMG-012 | 업로드 중 취소 가능 | P2 |

### 1.3 참고 링크 기능
| ID | 테스트 케이스 | 우선순위 |
|----|-------------|----------|
| REF-001 | 참고 링크 입력 필드 표시 | P0 |
| REF-002 | 유효한 URL 입력 시 성공 표시 | P0 |
| REF-003 | 무효한 URL 입력 시 에러 표시 | P0 |
| REF-004 | http/https만 허용 | P0 |
| REF-005 | 빈 값 허용 (선택 사항) | P0 |
| REF-006 | 게시글 생성 시 referenceUrl 포함 | P0 |

### 1.4 태그 자동완성 기능
| ID | 테스트 케이스 | 우선순위 |
|----|-------------|----------|
| TAG-001 | 포커스 시 인기 태그 표시 | P0 |
| TAG-002 | 2글자 미만 입력 시 추천 없음 | P0 |
| TAG-003 | 2글자 이상 입력 시 추천 표시 | P0 |
| TAG-004 | 디바운스 300ms 적용 | P1 |
| TAG-005 | 화살표 키로 항목 이동 | P1 |
| TAG-006 | Enter로 태그 선택 | P0 |
| TAG-007 | 클릭으로 태그 선택 | P0 |
| TAG-008 | ESC로 드롭다운 닫기 | P1 |
| TAG-009 | 선택된 태그 Badge로 표시 | P0 |
| TAG-010 | X 클릭으로 태그 제거 | P0 |
| TAG-011 | 최대 5개 제한 | P0 |
| TAG-012 | 중복 태그 방지 | P0 |

### 1.5 통합 테스트
| ID | 테스트 케이스 | 우선순위 |
|----|-------------|----------|
| INT-001 | 모든 필드 입력 후 게시하기 | P0 |
| INT-002 | 이미지 포함 게시글 작성 | P0 |
| INT-003 | 참고 링크 포함 게시글 작성 | P0 |
| INT-004 | 미리보기 후 수정 후 게시 | P1 |
| INT-005 | 게시 성공 후 상세 페이지 이동 | P0 |

---

## 2. 단위 테스트 시나리오

### 2.1 PreviewModal 컴포넌트
```typescript
describe('PreviewModal', () => {
  it('isOpen이 true일 때 모달이 표시됨');
  it('isOpen이 false일 때 모달이 숨겨짐');
  it('제목이 올바르게 표시됨');
  it('채널명이 올바르게 표시됨');
  it('태그들이 Badge로 표시됨');
  it('마크다운 내용이 HTML로 렌더링됨');
  it('이미지가 img 태그로 표시됨');
  it('참고 링크가 링크로 표시됨');
  it('닫기 버튼 클릭 시 onClose 호출');
  it('배경 클릭 시 onClose 호출');
  it('ESC 키 입력 시 onClose 호출');
  it('XSS 공격 코드가 sanitize됨');
});
```

### 2.2 ImageUpload 훅
```typescript
describe('useImageUpload', () => {
  it('파일 선택 시 업로드 시작');
  it('업로드 중 isUploading이 true');
  it('업로드 완료 시 URL 배열 반환');
  it('업로드 실패 시 에러 반환');
  it('10MB 초과 파일 거부');
  it('지원하지 않는 형식 거부');
  it('10장 초과 거부');
});
```

### 2.3 ReferenceUrlInput 컴포넌트
```typescript
describe('ReferenceUrlInput', () => {
  it('입력 필드가 렌더링됨');
  it('유효한 URL 입력 시 에러 없음');
  it('무효한 URL 입력 시 에러 표시');
  it('빈 값은 유효함');
  it('onChange 핸들러 호출됨');
});
```

### 2.4 TagAutocomplete 컴포넌트
```typescript
describe('TagAutocomplete', () => {
  it('포커스 시 인기 태그 드롭다운 표시');
  it('2글자 이상 입력 시 API 호출');
  it('디바운스 300ms 적용');
  it('추천 태그 클릭 시 onTagAdd 호출');
  it('Enter 키로 태그 추가');
  it('화살표 키로 항목 이동');
  it('선택된 태그 표시');
  it('태그 X 클릭 시 onTagRemove 호출');
  it('5개 초과 시 입력 비활성화');
  it('중복 태그 입력 방지');
});
```

---

## 3. E2E 테스트 시나리오

### 3.1 미리보기 E2E
```typescript
test.describe('미리보기 기능', () => {
  test('미리보기 모달 열기/닫기');
  test('마크다운 렌더링 확인');
  test('이미지 미리보기 확인');
});
```

### 3.2 이미지 업로드 E2E
```typescript
test.describe('이미지 업로드', () => {
  test('이미지 업로드 후 마크다운 삽입');
  test('여러 이미지 동시 업로드');
  test('드래그앤드롭 업로드');
});
```

### 3.3 게시글 작성 전체 플로우
```typescript
test.describe('게시글 작성 전체 플로우', () => {
  test('모든 기능 사용하여 게시글 작성');
});
```

---

## 4. 테스트 환경

### 4.1 단위 테스트
- **프레임워크**: Vitest
- **라이브러리**: @testing-library/react, @testing-library/user-event
- **모킹**: MSW (Mock Service Worker)

### 4.2 E2E 테스트
- **프레임워크**: Playwright
- **브라우저**: Chromium
- **환경**: 로컬 개발 서버 (localhost:3000)

### 4.3 테스트 데이터
- Mock 이미지 파일 (10KB JPEG)
- Mock 태그 데이터
- Mock 사용자 세션

---

## 5. 테스트 커버리지 목표

| 영역 | 목표 커버리지 |
|------|-------------|
| PreviewModal | > 90% |
| useImageUpload | > 90% |
| ReferenceUrlInput | > 90% |
| TagAutocomplete | > 90% |
| WritePage (통합) | > 80% |

---

## 6. 테스트 결과

### 6.1 단위 테스트 결과
- **총 테스트**: 201개
- **통과**: 201개
- **실패**: 0개
- **커버리지 달성**: 모든 목표 달성

| 컴포넌트/훅 | 테스트 수 | 결과 |
|------------|----------|------|
| PreviewModal | 13 | PASS |
| ReferenceUrlInput | 8 | PASS |
| TagAutocomplete | 22 | PASS |
| ImageUploadButton | 19 | PASS |
| useImageUpload | 9 | PASS |
| useTagSuggestion | 4 | PASS |
| WritePage | 17 | PASS |

### 6.2 E2E 테스트 결과
- **총 테스트**: 21개
- **통과**: 21개
- **실패**: 0개

| 카테고리 | 테스트 수 | 결과 |
|---------|----------|------|
| 페이지 기본 요소 | 3 | PASS |
| 미리보기 기능 (PRV) | 6 | PASS |
| 참고 링크 기능 (REF) | 4 | PASS |
| 태그 기능 (TAG) | 2 | PASS |
| 이미지 업로드 기능 (IMG) | 1 | PASS |
| 게시글 작성 전체 플로우 (INT) | 2 | PASS |
| 반응형 디자인 | 2 | PASS |
| 다크 모드 | 1 | PASS |

### 6.3 검증 완료 항목
- [x] 미리보기 모달 열기/닫기 (ESC, X 버튼)
- [x] 마크다운 렌더링
- [x] XSS 방지 (DOMPurify)
- [x] 참고 URL 유효성 검사
- [x] 태그 입력 및 Badge 표시
- [x] 이미지 업로드 영역
- [x] 필수 필드 입력 후 게시하기 버튼 활성화
- [x] 반응형 디자인 (모바일)
- [x] 다크 모드 지원

---

*QA 테스트 계획 작성일: 2026-01-15*
*QA 검증 완료일: 2026-01-15*
